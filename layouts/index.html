{{ define "main" }}
<div class="box" id="text">

	<h1>Matthew Kaul</h1>

	<p>Skeptical Christian humanist | essayist | lover of family, trees, rivers, &amp; books. <br />By day, I work as a <a href="https://medtronic.com">technical writer and project manager</a>. I live on seven acres in west-central Minnesota with my wife, some chickens and cats, and three human children. I write a <a href="https://mjkaul.substack.com/">newsletter on Substack</a>. <br />Recently, I made a mini-site of historical-philosophical <a href="https://mjkaul.github.io/math-explorations/">math explorations</a> for my daughter.
		
	<h2>Essays</h2>
			
	{{ range (where .Site.RegularPages "Section" "essays").ByDate.Reverse }}
	<p><a href="{{ .RelPermalink }}">{{ .Title }}</a> <em>({{ with .Params.progress }}{{ . }}% complete; {{ end }}last updated {{ .Lastmod.Format "02-Jan-2006" }})</em>{{ with .Params.description }} — {{ . }}{{ end }}
	{{ else }}
	<p><em>No essays yet.</em>
	{{ end }}

	<h2>Short Posts</h2>

	<div id="microblog-posts">
		<p><em>Loading...</em></p>
	</div>
	<p class="links"><a href="{{ .Site.Params.microblog_url }}">All short posts &rarr;</a></p>

<!--
	
	<h2>Other projects</h2>

	<p><a href="project1">example 1</a> is a explanation here.

	<p><a href="project2">example 2</a> is a explanation here.

	<h2>Archive</h2>

	<p><a href="archive1">Archive 1</a> with explanation here.

	<p><a href="archive2">Archive 2</a> with explanation here.

	<p><a href="archive3">Archive 3</a> with explanation here.

	-->

	<h2>Here's something interesting to read</h2>

	{{ $allItems := slice }}
	{{ range $feedURL := .Site.Data.feeds.feeds }}
		{{ with try (resources.GetRemote $feedURL) }}
			{{ with .Value }}
				{{ $feed := . | transform.Unmarshal }}
				{{ $source := "Unknown" }}
				{{/* RSS 2.0 format with rss wrapper */}}
				{{ with $feed.rss }}
					{{ with .channel.title }}{{ $source = . }}{{ end }}
					{{ with .channel.item }}
						{{ range . }}
							{{ $dateStr := .pubDate | time.AsTime | time.Format "2006-01-02T15:04:05Z" }}
							{{ $item := dict "title" .title "link" .link "pubDate" $dateStr "source" $source }}
							{{ $allItems = $allItems | append $item }}
						{{ end }}
					{{ end }}
				{{ end }}
				{{/* RSS 2.0 format without rss wrapper */}}
				{{ with $feed.channel }}
					{{ with .title }}{{ $source = . }}{{ end }}
					{{ with .item }}
						{{ range . }}
							{{ $dateStr := .pubDate | time.AsTime | time.Format "2006-01-02T15:04:05Z" }}
							{{ $item := dict "title" .title "link" .link "pubDate" $dateStr "source" $source }}
							{{ $allItems = $allItems | append $item }}
						{{ end }}
					{{ end }}
				{{ end }}
				{{/* Atom feed format - check for entry at top level */}}
				{{ with $feed.entry }}
					{{/* Get source name - may be string or map with #text */}}
					{{ with $feed.title }}
						{{ if reflect.IsMap . }}
							{{ with index . "#text" }}{{ $source = . }}{{ end }}
						{{ else }}
							{{ $source = . }}
						{{ end }}
					{{ end }}
					{{ range . }}
						{{/* Get link href */}}
						{{ $link := "" }}
						{{ with .link }}
							{{ if reflect.IsSlice . }}
								{{ range . }}
									{{ with index . "-href" }}{{ $link = . }}{{ end }}
								{{ end }}
							{{ else if reflect.IsMap . }}
								{{ with index . "-href" }}{{ $link = . }}{{ end }}
							{{ else }}
								{{ $link = . }}
							{{ end }}
						{{ end }}
						{{/* Get title text */}}
						{{ $title := "" }}
						{{ with .title }}
							{{ if reflect.IsMap . }}
								{{ with index . "#text" }}{{ $title = . }}{{ end }}
							{{ else }}
								{{ $title = . }}
							{{ end }}
						{{ end }}
						{{ $pubDate := .updated | default .published }}
						{{ $dateStr := $pubDate | time.AsTime | time.Format "2006-01-02T15:04:05Z" }}
						{{ $item := dict "title" $title "link" $link "pubDate" $dateStr "source" $source }}
						{{ $allItems = $allItems | append $item }}
					{{ end }}
				{{ end }}
			{{ end }}
		{{ end }}
	{{ end }}
	{{ range first 10 (sort $allItems "pubDate" "desc") }}
	<p><a href="{{ .link }}">{{ .title }}</a> <span class="feed-source">({{ .source }})</span>
	{{ else }}
	<p><em>No feed items available.</em>
	{{ end }}

	<h2>Blogroll</h2>

	<p>Justin Smith-Ruiu's <a href="https://www.the-hinternet.com/"><em>The Hinternet</em></a>. David Bentley Hart's <a href="https://davidbentleyhart.substack.com/"><em>Leaves in the Wind</em></a>. <a href="https://blog.ayjay.org/">Alan Jacobs</a>, esp. his <a href="https://blog.ayjay.org/my-books/">books</a>. <a href="https://www.robinsloan.com/">Robin Sloan</a>, master cultivator. <a href="https://ethaniverson.com/">Ethan Iverson</a>'s incredible interviews. Gioia brothers <a href="https://www.tedgioia.com/">Ted</a> and <a href="https://danagioia.com/">Dana</a>. My own brother, one of the brilliant <a href="https://buddy-buddy.co/">Buddy-Buddy</a> buddies.

	<p>One day, I hope to build a cabin in the woods just like the cabins built by <a href="https://www.youtube.com/@Bushradical">Bush Radical</a>.

	<h3>Indie Web</h3>

	<p><a href="https://beschizza.com/">Rob Beschizza</a>, writer and indie web developer (cf <a href="https://txt.fyi">txt.fyi</a>). I loved his homepage, obviously, & cloned it as the template for my own. <a href="https://www.manton.org/">Manton Reece</a>, esp. his <a href="https://micro.blog">Micro.blog</a> and his <a href="https://book.micro.blog/">book on the indie web</a>. <a href="https://www.htmlhobbyist.com/">HTML Hobbyist</a>, a great place to get started.

	<h3>Zettelkasten</h3>

	<p>My <a href="https://zettelkasten.de/introduction/">zettelkasten</a> organizes my reading, writing, and thinking. Learn from Bob Doto—<a href="https://www.amazon.com/dp/B0D18J83VB">book</a> & <a href="https://writing.bobdoto.computer/zettelkasten">blog</a>, <a href="https://boffosocko.com/tag/zettelkasten/">Chris Aldrich</a>, or simply by browsing the OG Niklas Luhmann's <a href="https://niklas-luhmann-archiv.de/nachlass/zettelkasten">digitized zettelkasten</a>. 
		
</div>

<script>
(function() {
	const microblogUrl = {{ .Site.Params.microblog_url }};
	const feedUrl = microblogUrl + '/feed.json';
	const container = document.getElementById('microblog-posts');

	fetch(feedUrl)
		.then(response => response.json())
		.then(data => {
			const posts = data.items.slice(0, 5);
			if (posts.length === 0) {
				container.innerHTML = '<p><em>No posts yet.</em></p>';
				return;
			}
			let html = '';
			posts.forEach(post => {
				const title = post.title || '';
				const content = post.content_html || post.content_text || '';
				const date = new Date(post.date_published).toLocaleDateString('en-US', {
					year: 'numeric', month: 'short', day: 'numeric'
				});
				const url = post.url;

				html += '<div class="microblog-post">';
				if (title) {
					html += '<p><strong><a href="' + url + '">' + title + '</a></strong></p>';
				}
				html += '<div class="microblog-content">' + content + '</div>';
				html += '<p class="microblog-meta"><a href="' + url + '">' + date + '</a></p>';
				html += '</div>';
			});
			container.innerHTML = html;
		})
		.catch(err => {
			container.innerHTML = '<p><em>Could not load posts.</em></p>';
		});
})();
</script>
{{ end }}
